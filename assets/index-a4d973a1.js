import{r as u,a as Ce,R as be}from"./vendor-b1791c80.js";import{C as ye,A as Se,T as ie,E as Te,a as Re,S as X,U as je,b as oe,X as _e,V as Ae,c as Ie,d as Oe,D as we,e as ke,M as Le,f as Ue,g as Me,h as ce,i as De}from"./icons-d50cacee.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function r(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(a){if(a.ep)return;a.ep=!0;const n=r(a);fetch(a.href,n)}})();var le={exports:{}},z={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pe=u,Fe=Symbol.for("react.element"),Ge=Symbol.for("react.fragment"),Be=Object.prototype.hasOwnProperty,Ye=Pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ve={key:!0,ref:!0,__self:!0,__source:!0};function de(t,s,r){var i,a={},n=null,c=null;r!==void 0&&(n=""+r),s.key!==void 0&&(n=""+s.key),s.ref!==void 0&&(c=s.ref);for(i in s)Be.call(s,i)&&!Ve.hasOwnProperty(i)&&(a[i]=s[i]);if(t&&t.defaultProps)for(i in s=t.defaultProps,s)a[i]===void 0&&(a[i]=s[i]);return{$$typeof:Fe,type:t,key:n,ref:c,props:a,_owner:Ye.current}}z.Fragment=Ge;z.jsx=de;z.jsxs=de;le.exports=z;var e=le.exports,J={},ne=Ce;J.createRoot=ne.createRoot,J.hydrateRoot=ne.hydrateRoot;const y={STARTING_MANPOWER:4,MANPOWER_PER_TURN:2,TOTAL_ROUNDS:6,METER_MIN:-5,METER_MAX:5,VICTORY_THRESHOLD:3,DEFEAT_THRESHOLD:-3,SAVE_KEY:"narrative-front-save",SETTINGS_KEY:"narrative-front-settings"},x={IGNORE:"IGNORE",FACT_CHECK:"FACT_CHECK",PRE_BUNK:"PRE_BUNK",COUNTER_NARRATIVE:"COUNTER_NARRATIVE",DISCREDIT_SOURCE:"DISCREDIT_SOURCE"},B={[x.IGNORE]:0,[x.FACT_CHECK]:2,[x.PRE_BUNK]:3,[x.COUNTER_NARRATIVE]:3,[x.DISCREDIT_SOURCE]:2},D=4,H={TRUE:"True",MOSTLY_TRUE:"Mostly True",MISLEADING:"Misleading",FALSE:"False"},Y={SUCCESS:"SUCCESS",NEUTRAL:"NEUTRAL",FAILURE:"FAILURE"},F={VOLUME:.4,LOOP:!0,FADE_DURATION:1e3,AUDIO_STATES:{FRACTURING:"fracturing",NEUTRAL:"neutral",UNITY:"unity"}},He={TYPEWRITER_SPEED:20,TYPEWRITER_SPEED_FAST:10,ANIMATION_DURATION:300,METER_ANIMATION_DURATION:1e3,KEYS:{ESCAPE:"Escape",ENTER:"Enter",TAB:"Tab",SPACE:" "}},$e={EN:"en",FR:"fr"},K=$e.EN,j={START:"start",BRIEFING:"briefing",GAME:"game",OUTCOME:"outcome",END:"end"},$={GAME_STATE:"narrative-front-game-state",SETTINGS:"narrative-front-settings",PROGRESS:"narrative-front-progress"},q={MANPOWER_BONUS_THOROUGH:.15,VARIANCE:.1,CRITICAL_SUCCESS_CHANCE:.05,CRITICAL_FAILURE_CHANCE:.05};function Ke(){const[t,s]=u.useState(0),[r,i]=u.useState(0),[a,n]=u.useState(y.STARTING_MANPOWER),[c,o]=u.useState([]),[l,m]=u.useState([]),d=u.useCallback(()=>{s(0),i(0),n(y.STARTING_MANPOWER),o([]),m([])},[]),p=u.useCallback(()=>{const h=t+1;s(h);const g=a+y.MANPOWER_PER_TURN;return n(g),h},[t,a]),v=u.useCallback(h=>{i(g=>{const w=g+h;return Math.max(y.METER_MIN,Math.min(y.METER_MAX,w))})},[]),C=u.useCallback(h=>{n(g=>Math.max(0,g-h))},[]),E=u.useCallback(h=>{n(g=>g+h)},[]),N=u.useCallback((h,g,w)=>{const V={round:t,scenarioId:h.id,inject:h.inject,responses:g,outcome:w,meterBefore:r,meterAfter:r+w.meterShift,manpowerSpent:w.manpowerCost,timestamp:new Date().toISOString()};return o(W=>[...W,V]),V},[t,r]),f=u.useCallback(h=>{m(g=>[...g,h])},[]),b=u.useCallback(h=>l.includes(h),[l]),O=u.useCallback(()=>{try{const h={round:t,meter:r,manpower:a,scenarioHistory:c,preBunksUsed:l,savedAt:new Date().toISOString()};return localStorage.setItem($.GAME_STATE,JSON.stringify(h)),!0}catch(h){return console.error("Failed to save game:",h),!1}},[t,r,a,c,l]),I=u.useCallback(()=>{try{const h=localStorage.getItem($.GAME_STATE);if(!h)return!1;const g=JSON.parse(h);return s(g.round),i(g.meter),n(g.manpower),o(g.scenarioHistory||[]),m(g.preBunksUsed||[]),!0}catch(h){return console.error("Failed to load game:",h),!1}},[]),U=u.useCallback(()=>!!localStorage.getItem($.GAME_STATE),[]),_=u.useCallback(()=>{localStorage.removeItem($.GAME_STATE)},[]),k=u.useCallback(()=>r>=y.VICTORY_THRESHOLD?"victory":r<=y.DEFEAT_THRESHOLD?"defeat":"neutral",[r]),A=u.useCallback(()=>t>=y.TOTAL_ROUNDS,[t]);return{round:t,meter:r,manpower:a,scenarioHistory:c,preBunksUsed:l,setRound:s,setMeter:i,setManpower:n,setScenarioHistory:o,resetGameState:d,advanceRound:p,updateMeter:v,spendManpower:C,addManpower:E,recordScenario:N,registerPreBunk:f,hasPreBunkFor:b,saveGame:O,loadGame:I,hasSavedGame:U,clearSavedGame:_,getGameOutcome:k,isGameOver:A}}const ze="modulepreload",We=function(t){return"/narrative-front-alpha-v2/"+t},re={},T=function(s,r,i){if(!r||r.length===0)return s();const a=document.getElementsByTagName("link");return Promise.all(r.map(n=>{if(n=We(n),n in re)return;re[n]=!0;const c=n.endsWith(".css"),o=c?'[rel="stylesheet"]':"";if(!!i)for(let d=a.length-1;d>=0;d--){const p=a[d];if(p.href===n&&(!c||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${n}"]${o}`))return;const m=document.createElement("link");if(m.rel=c?"stylesheet":ze,c||(m.as="script",m.crossOrigin=""),m.href=n,document.head.appendChild(m),c)return new Promise((d,p)=>{m.addEventListener("load",d),m.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>s()).catch(n=>{const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=n,window.dispatchEvent(c),!c.defaultPrevented)throw n})};function qe(t,s,r){const[i,a]=u.useState(!1),[n,c]=u.useState(null),[o,l]=u.useState(!1),m=u.useRef({fracturing:null,neutral:null,unity:null}),d=u.useRef(new Set),p=u.useCallback(async()=>{if(!(d.current.size>0)){l(!0);try{const[E,N,f]=await Promise.all([T(()=>import("./fracturing-82e36dd2.js"),[]),T(()=>import("./neutral-36a9fde6.js"),[]),T(()=>import("./unity-4b981931.js"),[])]);m.current.fracturing=new Audio(E.default),m.current.neutral=new Audio(N.default),m.current.unity=new Audio(f.default),Object.values(m.current).forEach(b=>{b.loop=F.LOOP,b.volume=F.VOLUME,b.preload="auto"}),d.current.add("fracturing"),d.current.add("neutral"),d.current.add("unity"),l(!1)}catch(E){console.error("Failed to load audio:",E),l(!1)}}},[]),v=u.useCallback(()=>t<=-2?"fracturing":t>=2?"unity":"neutral",[t]),C=u.useCallback(async(E,N)=>{const f=m.current[E],b=m.current[N];if(!f||!b)return;const O=F.FADE_DURATION,I=20,U=O/I;b.volume=0;try{await b.play()}catch(_){console.error("Audio play failed:",_);return}for(let _=0;_<=I;_++){const k=_/I;f&&!f.paused&&(f.volume=F.VOLUME*(1-k)),b&&!b.paused&&(b.volume=F.VOLUME*k),_<I&&await new Promise(A=>setTimeout(A,U))}f&&(f.pause(),f.currentTime=0)},[]);return u.useEffect(()=>{if(!i||r||d.current.size===0){Object.values(m.current).forEach(N=>{N&&!N.paused&&N.pause()}),c(null);return}if(s!==j.GAME&&s!==j.END){Object.values(m.current).forEach(N=>{N&&!N.paused&&N.pause()}),c(null);return}const E=v();if(E!==n){if(n)C(n,E);else{const N=m.current[E];N&&(N.volume=F.VOLUME,N.play().catch(f=>console.error("Audio play failed:",f)))}c(E)}},[t,s,r,i,n,v,C]),u.useEffect(()=>{i&&d.current.size===0&&p()},[i,p]),u.useEffect(()=>()=>{Object.values(m.current).forEach(E=>{E&&(E.pause(),E.src="")})},[]),{userInteracted:i,setUserInteracted:a,isLoading:o,activeTrack:n}}const Q=(t,s)=>{const r=t[s];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((i,a)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+s)))})};function Xe(t=K){const[s,r]=u.useState({}),[i,a]=u.useState(!0);return u.useEffect(()=>{(async()=>{try{a(!0);const o=await Q(Object.assign({"../data/i18n/en.json":()=>T(()=>import("./en-a745fe47.js"),[])}),`../data/i18n/${t}.json`);r(o.default||o)}catch(o){console.error(`Failed to load translations for language: ${t}`,o),r({})}finally{a(!1)}})()},[t]),{t:c=>{const o=c.split(".");let l=s;for(const m of o)if(l&&typeof l=="object"&&m in l)l=l[m];else return console.warn(`Translation key not found: ${c}`),c;return l},loading:i,translations:s}}const ue="/narrative-front-alpha-v2/assets/narrativeFront-7437ce01.svg",P=()=>e.jsx("footer",{style:{position:"fixed",bottom:0,left:0,width:"100vw",backgroundColor:"#000000",padding:"0.4rem 0",zIndex:9999,boxSizing:"border-box"},children:e.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 1rem",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx("a",{href:"https://playloadorg.github.io/landing-main-1/",target:"_blank",rel:"noopener noreferrer",style:{color:"#ffffff",fontSize:"0.75rem",textDecoration:"none",transition:"opacity 0.3s ease",whiteSpace:"nowrap"},onMouseEnter:t=>t.target.style.opacity="0.7",onMouseLeave:t=>t.target.style.opacity="1",children:"POWERED BY PLAYLOAD.ORG"})})});function Je({onStart:t,t:s}){return e.jsxs("div",{className:"screen-container start-screen",children:[e.jsxs("div",{className:"card start-card",children:[e.jsx("img",{src:ue,alt:"Narrative Front Logo",className:"logo"}),e.jsxs("div",{className:"title-container",children:[e.jsx("h1",{className:"main-title",children:s("start.title")}),e.jsx("p",{className:"brand-text",children:s("start.presenter")}),e.jsx("p",{className:"credit-text",children:s("start.credits")})]}),e.jsx("div",{className:"disclaimer-box",children:e.jsx("p",{className:"disclaimer-text",children:s("start.disclaimer")})}),e.jsx("button",{onClick:t,className:"button primary-button",autoFocus:!0,children:s("start.affirmButton")})]}),e.jsx(P,{})]})}function Z({text:t,speed:s=He.TYPEWRITER_SPEED,onComplete:r}){const[i,a]=u.useState(""),[n,c]=u.useState(0),[o,l]=u.useState(!1);u.useEffect(()=>{a(""),c(0),l(!1)},[t]),u.useEffect(()=>{if(n<t.length&&!o){const d=setTimeout(()=>{a(p=>p+t[n]),c(p=>p+1)},s);return()=>clearTimeout(d)}else n>=t.length&&!o&&(l(!0),r&&r())},[n,t,s,o,r]);const m=u.useCallback(()=>{o||(a(t),c(t.length),l(!0),r&&r())},[o,t,r]);return e.jsxs("span",{onClick:m,style:{cursor:o?"default":"pointer"},title:o?"":"Click to skip",children:[i,!o&&e.jsx("span",{className:"typewriter-cursor",children:"▌"})]})}function Qe({onStart:t,t:s}){const[r,i]=u.useState(!1),[a,n]=u.useState(!1);return u.useEffect(()=>{var c;a&&((c=document.getElementById("begin-button"))==null||c.focus())},[a]),e.jsxs("div",{className:"screen-container briefing-screen",children:[e.jsxs("div",{className:"card briefing-card",children:[e.jsx("div",{className:"briefing-quote",children:e.jsx(Z,{text:s("briefing.quote"),speed:30,onComplete:()=>i(!0)})}),r&&e.jsx("div",{className:"briefing-attribution",children:s("briefing.attribution")}),r&&e.jsx("div",{className:"briefing-text",children:e.jsx(Z,{text:s("briefing.text"),speed:15,onComplete:()=>n(!0)})}),a&&e.jsx("div",{className:"briefing-action",children:e.jsx("button",{id:"begin-button",onClick:t,className:"button primary-button",children:s("briefing.beginButton")})})]}),e.jsx(P,{})]})}const Ze=({value:t,t:s})=>{const r=y.METER_MAX-y.METER_MIN,a=(t-y.METER_MIN)/r*100;return e.jsxs("div",{className:"tug-of-war-container",children:[e.jsxs("div",{className:"tug-of-war-bar",children:[e.jsx("div",{className:"bar-color-fill",style:{clipPath:`inset(0 ${100-a}% 0 0)`}}),e.jsx("div",{className:"bar-marker",style:{left:`${a}%`},children:e.jsx("div",{className:"bar-marker-orb"})})]}),e.jsxs("div",{className:"bar-labels",children:[e.jsx("span",{className:"label-fragmentation",children:s("meter.fragmentationLabel")}),e.jsx("span",{className:"label-neutral",children:s("meter.neutralLabel")}),e.jsx("span",{className:"label-unity",children:s("meter.unityLabel")})]}),e.jsxs("div",{className:"meter-value",children:[s("meter.label"),": ",t>0?"+":"",t]})]})},me=({value:t,meterType:s="tugofwar",t:r})=>e.jsx(Ze,{value:t,t:r});function et({intelligence:t,t:s}){const r=o=>{switch(o){case H.TRUE:return"#4ade80";case H.MOSTLY_TRUE:return"#facc15";case H.MISLEADING:return"#fb923c";case H.FALSE:return"#ef4444";default:return"#6b7280"}},i=(o,l=10)=>{const m=o/l*100;return m<=33?"#4ade80":m<=66?"#facc15":"#ef4444"},n=(()=>{const o=(t.damagePotential+t.botAmplification/10)/2,l=t.hoursActive<=2?1.3:1,m=o*l;return m>=7?{label:s("intelligence.threatLevelCritical"),color:"#ef4444"}:m>=4?{label:s("intelligence.threatLevelHigh"),color:"#facc15"}:{label:s("intelligence.threatLevelModerate"),color:"#4ade80"}})(),c=[{icon:e.jsx(ye,{size:18}),label:s("intelligence.hoursActiveLabel"),value:`${t.hoursActive}${s("intelligence.hoursActiveUnit")}`,description:s("intelligence.hoursActiveDesc"),color:t.hoursActive<=2?"#ef4444":t.hoursActive<=6?"#facc15":"#4ade80"},{icon:e.jsx(Se,{size:18}),label:s("intelligence.botAmplificationLabel"),value:`${t.botAmplification}${s("intelligence.botAmplificationUnit")}`,description:s("intelligence.botAmplificationDesc"),barValue:t.botAmplification,barMax:100,color:i(t.botAmplification,100)},{icon:e.jsx(ie,{size:18}),label:s("intelligence.damagePotentialLabel"),value:`${t.damagePotential}${s("intelligence.damagePotentialScale")}`,description:s("intelligence.damagePotentialDesc"),barValue:t.damagePotential,barMax:10,color:i(t.damagePotential,10)},{icon:e.jsx(Te,{size:18}),label:s("intelligence.veracityLabel"),value:s(`intelligence.veracity${t.veracity.replace(/\s/g,"")}`),description:s("intelligence.veracityDesc"),color:r(t.veracity)},{icon:e.jsx(Re,{size:18}),label:s("intelligence.emotionalResonanceLabel"),value:`${t.emotionalResonance}${s("intelligence.emotionalResonanceScale")}`,description:s("intelligence.emotionalResonanceDesc"),barValue:t.emotionalResonance,barMax:10,color:i(t.emotionalResonance,10)}];return e.jsxs("div",{className:"intelligence-dashboard",children:[e.jsx("h4",{className:"intelligence-title",children:s("intelligence.title")}),e.jsx("div",{className:"threat-badge",style:{backgroundColor:`${n.color}20`,borderColor:n.color},children:e.jsx("span",{style:{color:n.color},children:n.label})}),e.jsx("div",{className:"metrics-grid",children:c.map((o,l)=>e.jsxs("div",{className:"metric-card",children:[e.jsxs("div",{className:"metric-header",children:[e.jsx("div",{className:"metric-icon",style:{color:o.color},children:o.icon}),e.jsxs("div",{className:"metric-info",children:[e.jsx("span",{className:"metric-label",children:o.label}),e.jsx("span",{className:"metric-value",style:{color:o.color},children:o.value})]})]}),o.barValue!==void 0&&e.jsx("div",{className:"metric-bar",children:e.jsx("div",{className:"metric-bar-fill",style:{width:`${o.barValue/o.barMax*100}%`,backgroundColor:o.color}})}),e.jsx("p",{className:"metric-description",children:o.description})]},l))})]})}function he({messages:t,t:s}){const r=u.useRef(null),[i,a]=u.useState([]);return u.useEffect(()=>{if(t.length===0){a([]);return}a([]),t.forEach((n,c)=>{setTimeout(()=>{a(o=>[...o,n])},c*100)})},[t]),u.useEffect(()=>{var n;(n=r.current)==null||n.scrollIntoView({behavior:"smooth"})},[i]),t.length===0?e.jsx("div",{className:"filter-chat-container",children:e.jsxs("div",{className:"filter-chat-empty",children:[e.jsx(X,{size:32,className:"filter-icon-large"}),e.jsx("p",{children:s("game.filterChatPlaceholder")})]})}):e.jsx("div",{className:"filter-chat-container",children:e.jsxs("div",{className:"filter-chat-messages",children:[i.map((n,c)=>e.jsxs("div",{className:`chat-message ${n.sender==="filter"?"filter-message":"system-message"}`,children:[e.jsx("div",{className:"message-avatar",children:n.sender==="filter"?e.jsx(X,{size:20}):e.jsx(je,{size:20})}),e.jsxs("div",{className:"message-content",children:[e.jsx("div",{className:"message-sender",children:n.sender==="filter"?"Filter":"System"}),e.jsx("div",{className:"message-text",children:c===i.length-1?e.jsx(Z,{text:n.text}):n.text})]})]},c)),e.jsx("div",{ref:r})]})})}function fe(t){return{sender:"filter",text:t,timestamp:Date.now()}}function tt(t){return{sender:"system",text:t,timestamp:Date.now()}}function st({selectedResponses:t,availableManpower:s,onSelectResponse:r,onRemoveResponse:i,t:a}){const n=d=>t.find(p=>p.type===d),c=d=>t.reduce((v,C)=>v+C.manpowerCost,0)+d<=s,o=[{type:x.IGNORE,title:a("responses.ignore.title"),description:a("responses.ignore.description"),cost:B[x.IGNORE],riskWarning:a("responses.ignore.riskWarning")},{type:x.FACT_CHECK,title:a("responses.factCheckBasic.title"),description:a("responses.factCheckBasic.description"),cost:B[x.FACT_CHECK],riskWarning:null,hasUpgrade:!0},{type:x.PRE_BUNK,title:a("responses.preBunk.title"),description:a("responses.preBunk.description"),cost:B[x.PRE_BUNK],riskWarning:a("responses.preBunk.riskWarning")},{type:x.COUNTER_NARRATIVE,title:a("responses.counterNarrative.title"),description:a("responses.counterNarrative.description"),cost:B[x.COUNTER_NARRATIVE],riskWarning:null},{type:x.DISCREDIT_SOURCE,title:a("responses.discreditSource.title"),description:a("responses.discreditSource.description"),cost:B[x.DISCREDIT_SOURCE],riskWarning:a("responses.discreditSource.riskWarning")}],l=d=>{n(d.type)?i(d.type):c(d.cost)&&r({type:d.type,manpowerCost:d.cost})},m=d=>{c(D)&&(i(d.type),r({type:d.type,manpowerCost:D}))};return e.jsx("div",{className:"response-panel",children:e.jsx("div",{className:"response-grid",children:o.map(d=>{const p=n(d.type),v=!!p,C=(p==null?void 0:p.manpowerCost)===D,E=c(d.cost);return e.jsxs("div",{className:"response-option-wrapper",children:[e.jsxs("button",{className:`response-option ${v?"selected":""} ${!E&&!v?"disabled":""}`,onClick:()=>l(d),disabled:!E&&!v,children:[e.jsxs("div",{className:"response-header",children:[e.jsx("div",{className:"response-title",children:d.title}),v&&e.jsx(oe,{size:18,className:"response-check-icon"})]}),e.jsx("div",{className:"response-description",children:d.description}),e.jsxs("div",{className:"response-footer",children:[e.jsxs("span",{className:"response-cost",children:[d.cost," MP"]}),d.riskWarning&&e.jsx("span",{className:"response-risk",children:"⚠️"})]}),d.riskWarning&&e.jsx("div",{className:"response-warning",children:d.riskWarning})]}),d.hasUpgrade&&v&&!C&&e.jsxs("button",{className:`response-upgrade ${c(D)?"":"disabled"}`,onClick:()=>m(d),disabled:!c(D),children:[e.jsxs("span",{children:["⬆️ ",a("responses.factCheckThorough.title")]}),e.jsxs("span",{className:"upgrade-cost",children:[D," MP"]})]}),d.hasUpgrade&&v&&C&&e.jsxs("div",{className:"response-thorough-badge",children:["✓ ",a("responses.factCheckThorough.title")]})]},d.type)})})})}function at({isOpen:t,onClose:s,isMuted:r,setIsMuted:i,onSaveGame:a,onLoadGame:n,hasSavedGame:c,t:o}){if(!t)return null;const l=()=>{a()&&console.log("Game saved successfully")},m=()=>{n()&&(console.log("Game loaded successfully"),s())};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"settings-overlay",onClick:s}),e.jsxs("div",{className:"settings-menu slide-in",children:[e.jsx("button",{className:"settings-close",onClick:s,"aria-label":o("accessibility.closeMenu"),children:e.jsx(_e,{size:24})}),e.jsx("h3",{className:"settings-title",children:o("settings.title")}),e.jsxs("button",{className:"button settings-button",onClick:()=>i(!r),children:[r?e.jsx(Ae,{size:20}):e.jsx(Ie,{size:20}),e.jsx("span",{children:o(r?"settings.unmuteButton":"settings.muteButton")})]}),e.jsx("div",{className:"settings-divider"}),e.jsxs("button",{className:"button settings-button",onClick:l,children:[e.jsx(Oe,{size:20}),e.jsx("span",{children:o("settings.saveGameButton")})]}),e.jsxs("button",{className:"button settings-button",onClick:m,disabled:!c,children:[e.jsx(we,{size:20}),e.jsx("span",{children:o("settings.loadGameButton")})]}),!c&&e.jsx("p",{className:"settings-note",children:o("settings.noSavedGame")||"No saved game available"})]})]})}function nt({outcome:t,scenario:s,onContinue:r,t:i}){const[a,n]=u.useState([]),[c,o]=u.useState(!1);return u.useEffect(()=>{var d;if(!t||!s)return;const l=[];t.outcomes&&t.outcomes.length>0&&t.outcomes.forEach(p=>{l.push(tt(p.text))}),(d=s.filter)!=null&&d.outro&&l.push(fe(s.filter.outro)),n(l);const m=setTimeout(()=>{o(!0)},1e3);return()=>clearTimeout(m)},[t,s]),t?e.jsxs("div",{className:"screen-container outcome-screen",children:[e.jsxs("div",{className:"card outcome-card",children:[e.jsx("h2",{className:"outcome-title",children:i("outcome.title")}),e.jsxs("div",{className:"outcome-summary",children:[e.jsxs("div",{className:"outcome-stat",children:[t.meterShift>0?e.jsx(ie,{className:"outcome-icon",style:{color:"#4ade80"},size:32}):t.meterShift<0?e.jsx(ke,{className:"outcome-icon",style:{color:"#f87171"},size:32}):e.jsx(Le,{className:"outcome-icon",style:{color:"#9ca3af"},size:32}),e.jsxs("div",{className:"outcome-stat-details",children:[e.jsx("span",{className:"outcome-stat-label",children:i("outcome.meterImpact")}),e.jsxs("span",{className:"outcome-stat-value",style:{color:t.meterShift>0?"#4ade80":t.meterShift<0?"#f87171":"#9ca3af"},children:[t.meterShift>0?"+":"",t.meterShift]})]})]}),e.jsxs("div",{className:"outcome-stat",children:[e.jsx(Ue,{className:"outcome-icon",style:{color:"#22d3ee"},size:32}),e.jsxs("div",{className:"outcome-stat-details",children:[e.jsx("span",{className:"outcome-stat-label",children:i("outcome.manpowerSpent")}),e.jsx("span",{className:"outcome-stat-value",style:{color:"#22d3ee"},children:t.manpowerCost})]})]})]}),e.jsxs("div",{style:{marginTop:"1.5rem",marginBottom:"1.5rem"},children:[e.jsx("h3",{style:{fontSize:"1.125rem",color:"#22d3ee",marginBottom:"1rem",textAlign:"center"},children:i("outcome.analysis")}),e.jsx(he,{messages:a,t:i})]}),c&&e.jsx("button",{onClick:r,className:"button primary-button full-width",autoFocus:!0,children:i("outcome.continueButton")})]}),e.jsx(P,{})]}):e.jsxs("div",{className:"screen-container outcome-screen",children:[e.jsx("div",{className:"card",children:e.jsx("p",{children:i("ui.loading")})}),e.jsx(P,{})]})}function rt(){const[t,s]=u.useState(null),[r,i]=u.useState(!1),a=u.useRef({}),n=u.useCallback(async(o,l=K)=>{const m=`${o}-${l}`;if(a.current[m]){s(a.current[m]);return}try{i(!0);const d=String(o+1).padStart(2,"0"),p=await Q(Object.assign({"../data/scenarios/scenario-01-en.json":()=>T(()=>import("./scenario-01-en-247b2d75.js"),[]),"../data/scenarios/scenario-02-en.json":()=>T(()=>import("./scenario-02-en-6e92b6f4.js"),[]),"../data/scenarios/scenario-03-en.json":()=>T(()=>import("./scenario-03-en-1efa7df5.js"),[]),"../data/scenarios/scenario-04-en.json":()=>T(()=>import("./scenario-04-en-d7c28cd1.js"),[]),"../data/scenarios/scenario-05-en.json":()=>T(()=>import("./scenario-05-en-efa53591.js"),[]),"../data/scenarios/scenario-06-en.json":()=>T(()=>import("./scenario-06-en-eb0da137.js"),[])}),`../data/scenarios/scenario-${d}-${l}.json`),v=p.default||p;a.current[m]=v,s(v)}catch(d){console.error(`Failed to load scenario ${o} in language ${l}:`,d),s(null)}finally{i(!1)}},[]),c=u.useCallback(async(o,l=K)=>{const m=o+1,d=`${m}-${l}`;if(!a.current[d])try{const p=String(m+1).padStart(2,"0"),v=await Q(Object.assign({"../data/scenarios/scenario-01-en.json":()=>T(()=>import("./scenario-01-en-247b2d75.js"),[]),"../data/scenarios/scenario-02-en.json":()=>T(()=>import("./scenario-02-en-6e92b6f4.js"),[]),"../data/scenarios/scenario-03-en.json":()=>T(()=>import("./scenario-03-en-1efa7df5.js"),[]),"../data/scenarios/scenario-04-en.json":()=>T(()=>import("./scenario-04-en-d7c28cd1.js"),[]),"../data/scenarios/scenario-05-en.json":()=>T(()=>import("./scenario-05-en-efa53591.js"),[]),"../data/scenarios/scenario-06-en.json":()=>T(()=>import("./scenario-06-en-eb0da137.js"),[])}),`../data/scenarios/scenario-${p}-${l}.json`),C=v.default||v;a.current[d]=C}catch{console.debug(`Could not preload scenario ${m}`)}},[]);return{currentScenario:t,loading:r,loadScenario:n,preloadNextScenario:c}}const it={version:"1.0.0",description:"Generic outcome text templates by response type and result",lastUpdated:"2025-01-17"},ot={SUCCESS:[{shift:1,text:"Your rapid and clear fact-check was picked up by credible media, effectively neutralizing the claim for a majority of the public."},{shift:1,text:"Technical analysis exposed the false claim. Major outlets reported your debunking, significantly limiting the narrative's spread."},{shift:2,text:"Your comprehensive fact-check with verifiable evidence went viral positively, overwhelming the adversary's narrative."}],NEUTRAL:[{shift:0,text:"The fact-check circulated among journalists and experts but failed to penetrate the social media bubbles where the lie was spreading."},{shift:0,text:"Your correction reached informed audiences but didn't break through to those already convinced by the narrative."},{shift:0,text:"While technically accurate, your fact-check lacked the emotional resonance needed to counter the adversary's compelling story."}],FAILURE:[{shift:-1,text:"Your response was too slow or too technical. The adversary spun your correction as 'official propaganda,' further muddying the waters."},{shift:-1,text:"By the time your fact-check appeared, the narrative had solidified. Your denial was treated as confirmation by suspicious audiences."},{shift:-2,text:"Your fact-check was too aggressive and defensive in tone, making you appear threatened. The Streisand effect amplified the original claim."}]},ct={SUCCESS:[{shift:3,text:"Your prior warnings about these specific manipulation tactics paid off. The adversary's attempt was widely recognized as hostile propaganda and dismissed, significantly boosting public resilience."},{shift:3,text:"Because you pre-bunked this type of narrative, audiences were psychologically inoculated. The claim failed to gain traction and was mocked as predictable propaganda."},{shift:2,text:"Your pre-emptive education created skepticism among key audiences. While the narrative spread in fringe circles, mainstream rejection was swift."}],NEUTRAL:[{shift:0,text:"Your pre-bunking had some effect among attentive audiences, but the adversary's narrative still found purchase in less-informed communities."},{shift:0,text:"The pre-bunk helped somewhat, but the emotional power of the adversary's claim overcame rational preparation for many people."}],FAILURE:[{shift:-1,text:"Despite your warnings, the hostile narrative was compelling enough to take root. Your pre-bunking had minimal effect, and valuable resources were expended."},{shift:-1,text:"Your pre-bunking was too vague or poorly targeted. When the actual narrative hit, audiences didn't make the connection."}]},lt={SUCCESS:[{shift:1,text:"A risky gamble that paid off. The claim was too absurd to gain traction on its own and quickly faded into obscurity without your intervention."},{shift:1,text:"By not engaging, you avoided amplifying a fringe narrative. It burned out naturally among small circles."}],NEUTRAL:[{shift:0,text:"The hostile narrative didn't explode, but it continues to simmer in fringe communities, creating a low level of background noise and doubt."},{shift:0,text:"Your silence neither helped nor harmed significantly. The narrative exists but hasn't reached critical mass."}],FAILURE:[{shift:-3,text:"Your silence was interpreted as guilt. The narrative went viral, treated as confirmed truth by adversaries, and caused significant damage to public trust."},{shift:-2,text:"Ignoring allowed the rumor to spread unchecked. Public doubt increased as no authoritative voice countered the claims."},{shift:-2,text:"Without your response, adversary media amplified the narrative as 'the story NATO doesn't want you to know.' Silence became complicity."}]},dt={SUCCESS:[{shift:2,text:"Your powerful, positive stories completely shifted the media focus. The adversary's narrative was drowned out by a wave of compelling, authentic content."},{shift:2,text:"Your counter-narrative with genuine human stories and verifiable positive impact went viral, overwhelming the adversary's messaging."},{shift:1,text:"The positive narrative gained significant traction, providing audiences an alternative story to believe in."}],NEUTRAL:[{shift:0,text:"Your positive messaging was well-received but didn't directly address the hostile claim, which continued to circulate and cause damage in specific circles."},{shift:0,text:"The counter-narrative competed with the adversary's story but neither dominated. Public opinion remained divided."},{shift:0,text:"While your positive stories resonated with supporters, they didn't reach the audiences most affected by the adversary's claims."}],FAILURE:[{shift:-1,text:"Your counter-narrative was perceived as a clumsy attempt to 'change the subject' and was called out by critics, making you appear evasive."},{shift:-1,text:"The timing and tone of your positive messaging felt tone-deaf given the serious allegations. It backfired by seeming dismissive of legitimate concerns."},{shift:-2,text:"Your counter-narrative was too obviously crafted and inauthentic. Audiences saw through it, damaging credibility further."}]},ut={SUCCESS:[{shift:1,text:"You successfully exposed the source as a known disinformation agent with clear ties to hostile actors. The claim was discredited among informed audiences."},{shift:1,text:"Your investigation revealed the source's funding and affiliations. Independent media picked up your exposé, undermining the narrative's credibility."},{shift:2,text:"Comprehensive evidence of the source's malicious intent and fabrication history went viral, completely destroying their credibility."}],NEUTRAL:[{shift:0,text:"While you proved the source was unreliable, the message had already detached from the messenger and was spreading organically among those who wanted to believe it."},{shift:0,text:"Your attack on the source had mixed results. Skeptics appreciated the evidence, but true believers dismissed it as an ad hominem attack."}],FAILURE:[{shift:-2,text:"Your attack on the source backfired spectacularly. It was framed as an attempt to silence dissent, creating a martyr and making you look defensive and aggressive. The situation is now significantly worse."},{shift:-2,text:"Attacking the messenger was seen as avoiding the message. Critics accused you of deflection, and the narrative gained legitimacy through your perceived fear."},{shift:-1,text:"Your discrediting attempt was too aggressive. It played into the 'powerful NATO silencing critics' narrative the adversary wanted."}]},mt={SYNERGY_PREBUNK_FACTCHECK:{shift:1,bonus:"Pre-bunking prepared audiences to trust your fact-check. The combination was highly effective."},SYNERGY_COUNTER_FACTCHECK:{shift:1,bonus:"Debunking the lie while providing a positive alternative created a powerful one-two punch."},SYNERGY_FACTCHECK_DISCREDIT:{shift:0,bonus:"Attacking both the message and the messenger felt thorough but perhaps overly aggressive to some audiences."},INEFFICIENCY_MULTIPLE_FACTCHECKS:{shift:-1,penalty:"Using multiple fact-checking efforts on the same narrative was redundant and wasted resources."},INEFFICIENCY_IGNORE_THEN_RESPOND:{shift:-1,penalty:"Inconsistent strategy. Ignoring then responding appeared indecisive and reactive."}},ht={CRITICAL_SUCCESS:{shift:3,text:"CRITICAL SUCCESS: Your response was perfectly timed and executed. The adversary's operation completely collapsed, and public trust actually increased."},CRITICAL_FAILURE:{shift:-3,text:"CRITICAL FAILURE: Your response catastrophically backfired. The adversary used your actions as proof of their narrative, causing massive damage."}},ft={meta:it,FACT_CHECK:ot,PRE_BUNK:ct,IGNORE:lt,COUNTER_NARRATIVE:dt,DISCREDIT_SOURCE:ut,COMBINED:mt,CRITICAL_OUTCOMES:ht};class pt{constructor(){this.outcomes=ft}calculateOutcome(s,r,i){const{preBunksUsed:a=[]}=i,n=this.calculateManpowerCost(r),c=r.map(d=>this.processResponse(d,s,a));let o=c.reduce((d,p)=>d+p.shift,0);const l=c.map(d=>d.narrative),m=this.checkSynergies(r,s);return m&&(l.push(m.narrative),o+=m.shift),{meterShift:Math.max(-5,Math.min(5,o)),manpowerCost:n,outcomes:l,responses:r.map(d=>d.type),success:o>0}}calculateManpowerCost(s){return s.reduce((r,i)=>r+(i.manpowerCost||0),0)}processResponse(s,r,i){const a=s.type,n=r.probabilities[a];if(!n)return console.error(`No probabilities found for response type: ${a}`),{shift:0,narrative:{text:"Unknown response type."}};const c=i.includes(r.metadata.theme);let o=n.success,l=n.neutral,m=n.failure;a===x.FACT_CHECK&&s.manpowerCost===D&&(o+=n.thorough_bonus||0,m-=n.thorough_bonus||0),c&&a===x.PRE_BUNK&&(o=Math.min(1,o+.2),m=Math.max(0,m-.2));const d=(Math.random()-.5)*q.VARIANCE*2;o+=d,m-=d;const p=o+l+m;o/=p,l/=p,m/=p;const v=Math.random();let C;v<o?C=Y.SUCCESS:v<o+l?C=Y.NEUTRAL:C=Y.FAILURE;const E=Math.random();if(E<q.CRITICAL_SUCCESS_CHANCE&&C===Y.SUCCESS)return this.getCriticalOutcome(!0);if(E<q.CRITICAL_FAILURE_CHANCE&&C===Y.FAILURE)return this.getCriticalOutcome(!1);const N=this.selectNarrative(a,C);return{shift:N.shift,narrative:{text:N.text}}}selectNarrative(s,r){var n;const i=(n=this.outcomes[s])==null?void 0:n[r];return!i||i.length===0?(console.warn(`No narrative found for ${s} - ${r}`),{shift:0,text:"The situation evolves..."}):i[Math.floor(Math.random()*i.length)]}getCriticalOutcome(s){const r=s?this.outcomes.CRITICAL_OUTCOMES.CRITICAL_SUCCESS:this.outcomes.CRITICAL_OUTCOMES.CRITICAL_FAILURE;return{shift:r.shift,narrative:{text:r.text}}}checkSynergies(s,r){if(s.length<2)return null;const i=s.map(n=>n.type);return i.includes(x.PRE_BUNK)&&i.includes(x.FACT_CHECK)?{shift:1,narrative:{text:this.outcomes.COMBINED.SYNERGY_PREBUNK_FACTCHECK.bonus}}:i.includes(x.COUNTER_NARRATIVE)&&i.includes(x.FACT_CHECK)?{shift:1,narrative:{text:this.outcomes.COMBINED.SYNERGY_COUNTER_FACTCHECK.bonus}}:i.includes(x.FACT_CHECK)&&i.includes(x.DISCREDIT_SOURCE)?{shift:0,narrative:{text:this.outcomes.COMBINED.SYNERGY_FACTCHECK_DISCREDIT.bonus}}:i.filter(n=>n===x.FACT_CHECK).length>1?{shift:-1,narrative:{text:this.outcomes.COMBINED.INEFFICIENCY_MULTIPLE_FACTCHECKS.penalty}}:null}}function gt({round:t,meter:s,manpower:r,preBunksUsed:i,language:a,isMuted:n,setIsMuted:c,onMeterChange:o,onManpowerChange:l,onAdvanceRound:m,onRegisterPreBunk:d,onRecordScenario:p,onSaveGame:v,onLoadGame:C,onGameEnd:E,hasSavedGame:N,t:f}){const[b,O]=u.useState("scenario"),[I,U]=u.useState(!1),[_,k]=u.useState(!1),[A,h]=u.useState([]),[g,w]=u.useState(null),[V,W]=u.useState([]),{currentScenario:R,loading:pe,loadScenario:ee,preloadNextScenario:te}=rt(),ge=u.useRef(new pt);u.useEffect(()=>{ee(t,a)},[t,a,ee]),u.useEffect(()=>{var S;(S=R==null?void 0:R.filter)!=null&&S.intro&&W([fe(R.filter.intro)])},[R]),u.useEffect(()=>{R&&t<y.TOTAL_ROUNDS-1&&te(t,a)},[R,t,a,te]);const ve=S=>{const M=A.find(L=>L.type===S.type);h(M?L=>L.map(G=>G.type===S.type?S:G):L=>[...L,S])},Ee=S=>{h(M=>M.filter(L=>L.type!==S))},xe=()=>{const S=A.length>0?A:[{type:x.IGNORE,manpowerCost:0}],M=ge.current.calculateOutcome(R,S,{meter:s,manpower:r,preBunksUsed:i});S.forEach(L=>{var G;L.type===x.PRE_BUNK&&((G=R.metadata)!=null&&G.theme)&&d(R.metadata.theme)}),p(R,S,M),w(M),k(!0)},Ne=()=>{if(g){if(o(g.meterShift),l(-g.manpowerCost),t>=y.TOTAL_ROUNDS-1){E();return}m(),k(!1),w(null),h([]),O("scenario")}},se=()=>A.reduce((S,M)=>S+M.manpowerCost,0),ae=()=>se()<=r;return _&&g?e.jsx(nt,{outcome:g,scenario:R,onContinue:Ne,t:f}):pe||!R?e.jsxs("div",{className:"screen-container game-screen",children:[e.jsx("div",{className:"card",children:e.jsx("p",{children:f("ui.loading")})}),e.jsx(P,{})]}):e.jsxs("div",{className:"screen-container game-screen",children:[e.jsx(at,{isOpen:I,onClose:()=>U(!1),isMuted:n,setIsMuted:c,onSaveGame:v,onLoadGame:C,hasSavedGame:N,t:f}),e.jsxs("div",{className:`card game-card ${I?"blurred":""}`,children:[e.jsxs("header",{className:"game-header",children:[e.jsx("button",{className:"settings-hamburger",onClick:()=>U(!0),"aria-label":f("accessibility.menuButton"),children:e.jsx(Me,{size:24})}),e.jsxs("div",{className:"header-title-container",children:[e.jsx(X,{className:"header-icon"}),e.jsx("span",{className:"header-title",children:f("game.appTitle")})]}),e.jsx("img",{src:ue,alt:"Narrative Front Logo",className:"header-logo"})]}),e.jsx("div",{className:"header-subtitle",children:f("game.appSubtitle")}),e.jsxs("div",{className:"resource-display",children:[e.jsxs("div",{className:"resource-item",children:[e.jsxs("span",{className:"resource-label",children:[f("game.manpowerLabel"),":"]}),e.jsx("span",{className:"resource-value",children:r})]}),e.jsxs("div",{className:"resource-item",children:[e.jsxs("span",{className:"resource-label",children:[f("game.roundLabel"),":"]}),e.jsxs("span",{className:"resource-value",children:[t+1," ",f("game.ofLabel")," ",y.TOTAL_ROUNDS]})]})]}),e.jsx(me,{value:s,meterType:"tugofwar",t:f}),e.jsxs("div",{className:"tab-navigation",children:[e.jsx("button",{className:`tab-button ${b==="scenario"?"active":""}`,onClick:()=>O("scenario"),children:f("game.tabScenario")}),e.jsx("button",{className:`tab-button ${b==="response"?"active":""}`,onClick:()=>O("response"),children:f("game.tabResponse")}),e.jsx("button",{className:`tab-button ${b==="filter"?"active":""}`,onClick:()=>O("filter"),children:f("game.tabFilter")})]}),e.jsxs("div",{className:"tab-content",children:[b==="scenario"&&e.jsxs("div",{className:"scenario-tab",children:[e.jsxs("div",{className:"inject-section",children:[e.jsxs("div",{className:"inject-header",children:[e.jsx(ce,{className:"inject-icon"}),e.jsx("h3",{className:"inject-title",children:f("game.adversaryInject")})]}),e.jsx("p",{className:"inject-text",children:R.inject})]}),e.jsx(et,{intelligence:R.intelligence,t:f})]}),b==="response"&&e.jsxs("div",{className:"response-tab",children:[e.jsx("h3",{className:"response-tab-title",children:f("game.yourResponse")}),e.jsx("div",{className:"manpower-summary",children:e.jsxs("span",{children:[f("game.manpowerAllocated"),": ",se()," / ",r]})}),e.jsx(st,{selectedResponses:A,availableManpower:r,onSelectResponse:ve,onRemoveResponse:Ee,t:f}),e.jsx("button",{onClick:xe,disabled:!ae(),className:"button primary-button full-width confirm-response-button",children:A.length===0?f("responses.noResponseSelected"):f("game.confirmButton")}),!ae()&&e.jsx("p",{className:"error-text",children:f("responses.insufficientManpower")})]}),b==="filter"&&e.jsxs("div",{className:"filter-tab",children:[e.jsx("h3",{className:"filter-tab-title",children:f("game.filterChatTitle")}),e.jsx(he,{messages:V,t:f})]})]}),e.jsxs("footer",{className:"game-footer",children:[f("game.roundLabel")," ",t+1," ",f("game.ofLabel")," ",y.TOTAL_ROUNDS]})]}),e.jsx(P,{})]})}function vt({meter:t,manpower:s,scenarioHistory:r,onPlayAgain:i,t:a}){const c=(()=>t>=y.VICTORY_THRESHOLD?{type:"victory",title:a("end.victoryTitle"),message:a("end.victoryMessage"),icon:e.jsx(oe,{className:"end-icon"}),colorClass:"text-green"}:t<=y.DEFEAT_THRESHOLD?{type:"defeat",title:a("end.defeatTitle"),message:a("end.defeatMessage"),icon:e.jsx(De,{className:"end-icon"}),colorClass:"text-red"}:{type:"neutral",title:a("end.neutralTitle"),message:a("end.neutralMessage"),icon:e.jsx(ce,{className:"end-icon"}),colorClass:"text-yellow"})();return e.jsxs("div",{className:"screen-container end-screen",children:[e.jsxs("div",{className:"card end-card",children:[e.jsx("div",{className:`end-icon-container ${c.colorClass}`,children:c.icon}),e.jsx("h2",{className:`end-title ${c.colorClass}`,children:c.title}),e.jsx(me,{value:t,meterType:"tugofwar",t:a}),e.jsx("p",{className:"end-message",children:c.message}),e.jsxs("div",{className:"end-stats",children:[e.jsxs("div",{className:"end-stat-row",children:[e.jsxs("span",{className:"end-stat-label",children:[a("end.finalMeterLabel"),":"]}),e.jsxs("span",{className:`end-stat-value ${c.colorClass}`,children:[t>0?"+":"",t]})]}),e.jsxs("div",{className:"end-stat-row",children:[e.jsxs("span",{className:"end-stat-label",children:[a("end.finalManpowerLabel"),":"]}),e.jsx("span",{className:"end-stat-value",children:s})]}),e.jsxs("div",{className:"end-stat-row",children:[e.jsxs("span",{className:"end-stat-label",children:[a("end.scenariosCompletedLabel"),":"]}),e.jsx("span",{className:"end-stat-value",children:r.length})]})]}),e.jsx("div",{className:"end-actions",children:e.jsx("button",{onClick:i,className:"button primary-button full-width",autoFocus:!0,children:a("end.playAgainButton")})})]}),e.jsx(P,{})]})}function Et(){const[t,s]=u.useState(j.START),[r,i]=u.useState(!1),[a,n]=u.useState(K),{t:c,loading:o}=Xe(),l=Ke(),{userInteracted:m,setUserInteracted:d}=qe(l.meter,t,r);u.useEffect(()=>{try{const h=localStorage.getItem("narrative-front-settings");if(h){const g=JSON.parse(h);g.isMuted!==void 0&&i(g.isMuted),g.language&&n(g.language)}}catch(h){console.error("Failed to load settings:",h)}},[]),u.useEffect(()=>{try{const h={isMuted:r,language:a};localStorage.setItem("narrative-front-settings",JSON.stringify(h))}catch(h){console.error("Failed to save settings:",h)}},[r,a]);const p=()=>{m||d(!0),s(j.BRIEFING)},v=()=>{l.resetGameState(),s(j.GAME)},C=()=>{s(j.END)},E=()=>{l.resetGameState(),s(j.BRIEFING)},N=()=>{s(j.START)},f=h=>{l.updateMeter(h)},b=h=>{h<0?l.spendManpower(Math.abs(h)):l.addManpower(h)},O=()=>l.advanceRound(),I=(h,g,w)=>{l.recordScenario(h,g,w)},U=h=>{l.registerPreBunk(h)},_=()=>l.saveGame(),k=()=>{const h=l.loadGame();return h&&s(j.GAME),h};if(o)return e.jsx("div",{className:"screen-container",children:e.jsx("div",{className:"card",children:e.jsx("p",{children:"Loading..."})})});const A=()=>{switch(t){case j.START:return e.jsx(Je,{onStart:p,t:c});case j.BRIEFING:return e.jsx(Qe,{onStart:v,t:c});case j.GAME:return e.jsx(gt,{round:l.round,meter:l.meter,manpower:l.manpower,preBunksUsed:l.preBunksUsed,language:a,isMuted:r,setIsMuted:i,onMeterChange:f,onManpowerChange:b,onAdvanceRound:O,onRegisterPreBunk:U,onRecordScenario:I,onSaveGame:_,onLoadGame:k,onGameEnd:C,hasSavedGame:l.hasSavedGame(),t:c});case j.END:return e.jsx(vt,{meter:l.meter,manpower:l.manpower,scenarioHistory:l.scenarioHistory,onPlayAgain:E,t:c});default:return e.jsx("div",{className:"screen-container",children:e.jsxs("div",{className:"card",children:[e.jsx("p",{children:"Error: Unknown screen state"}),e.jsx("button",{onClick:N,className:"button primary-button",children:"Return to Start"})]})})}};return e.jsx("div",{className:"app",children:A()})}J.createRoot(document.getElementById("root")).render(e.jsx(be.StrictMode,{children:e.jsx(Et,{})}));
